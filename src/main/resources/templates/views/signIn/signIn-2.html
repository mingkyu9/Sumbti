<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org"
       xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
       layout:decorate="~{layout/main_layout}">
<th:block layout:fragment="css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <style>

        @font-face {
            font-family: 'GmarketSansMedium';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'GmarketSansLight';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansLight.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'GmarketSansBold';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansBold.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        #signInLogo {
            text-align: center;
            font-family: 'GmarketSansBold', sans-serif;
            margin-top: 35px;
            margin-bottom: 35px;
        }

        .form {
            border-top: 1px solid rgb(98, 98, 98);
            margin-top : 10px;
            padding:30px;
            padding-top: 60px;
            border-radius: 5px;
        }

        .imgArea {
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .center-input {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* Add styles specific to the custom-name-input class */
        .custom-name-input {
            text-align: center;
        }

        /* ì„±ë³„ ì˜µì…˜ ì»¨í…Œì´ë„ˆì˜ ìŠ¤íƒ€ì¼ */
        .gender-options {
            display: flex;
            justify-content: space-evenly;
        }

        .gender-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px; /* ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš”. */
            background-color: #f0f0f0; /* íšŒìƒ‰ ë°°ê²½ìƒ‰ ì¶”ê°€ */
            border-radius: 15px; /* border-radius ì¶”ê°€ */
            cursor: pointer;
            transition: all 0.3s ease-in-out; /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ìœ„í•œ íŠ¸ëœì§€ì…˜ ì¶”ê°€ */
        }

        /* ì²´í¬ ë°•ìŠ¤ì˜ ìŠ¤íƒ€ì¼ */
        .gender-checkbox {
            display: none; /* ì‹¤ì œ ì²´í¬ ë°•ìŠ¤ë¥¼ ìˆ¨ê¹€ */
        }

        /* ë¼ë²¨(ì´ë¯¸ì§€ í¬í•¨)ì˜ ìŠ¤íƒ€ì¼ */
        .gender-option label {
            cursor: pointer;
            border: 2px solid transparent; /* ì´ˆê¸°ì—ëŠ” í…Œë‘ë¦¬ê°€ ì—†ìŒ */
            transition: border-color 0.3s ease-in-out;
            width: 180px; /* ì„ íƒ ì‹œ í¬ê¸° ì¡°ì • (ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš”) */
            height: 180px; /* ì„ íƒ ì‹œ í¬ê¸° ì¡°ì • (ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš”) */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* ì²´í¬ ë°•ìŠ¤ê°€ ì„ íƒë˜ë©´ ë¼ë²¨ì˜ í…Œë‘ë¦¬ ìƒ‰ìƒì„ ë³€ê²½ */
        .gender-checkbox:checked + label {
            border-color: #456173; /* ì„ íƒë˜ë©´ í…Œë‘ë¦¬ ìƒ‰ìƒ ì¶”ê°€ */
            border-radius: 15px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì íš¨ê³¼ ì¶”ê°€ */
            width: 180px; /* ì„ íƒ ì‹œ í¬ê¸° ì¡°ì • (ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš”) */
            height: 180px; /* ì„ íƒ ì‹œ í¬ê¸° ì¡°ì • (ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš”) */
        }

        .mbtiChk .form-check-input {
            transform: scale(1.5); /* ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆ (ì˜ˆ: 1.5ëŠ” 1.5ë°° í¬ê²Œ) */
            margin-right: 10px;
        }

        .mbtiChk .form-check-label {
            margin-right:10px;
            font-family: 'GmarketSansMedium', sans-serif;
        }

        .form-group  input {
            width: 500px;
            height: 60px;
            margin-left: -9px;
            margin-top: 15px;
            font-size: 20px;
        }

        .form-group  textarea{
            resize: none;
            outline: none;
            width: 100%;

        }

        .btn-area {
            width: 100%;
            height: 30px;
            line-height: 30px;
            text-align: right;
            padding-right : 30px;
            margin-bottom: 65px;
            font-family: 'GmarketSansLight', sans-serif
        }

        .nav-item {
            font-family: 'GmarketSansBold', sans-serif;
            font-size: 25px;
        }

    </style>
</th:block>
<!-- main_layout ì— ì†í•  í˜ì´ì§€ ì´ê¸°ë•Œë¬¸ì— ë‚´ìš©ë§Œ ìˆìœ¼ë©´ ëœë‹¤ -->
<div layout:fragment="content">
    <div class="container">
        <div class="contents">
            <div id="signInLogo">
                <h2 style="font-size: 60px;">íšŒì›ê°€ì…</h2>
            </div>
            <div class="form">
                <form  id="frm"v enctype="">
                    <div class="form-group" style="margin-left:10px; margin-bottom: 50px; font-size:30px; font-family: 'GmarketSansMedium', sans-serif;">
                        <label for="profilePicture">í”„ë¡œí•„ì„ ì„¤ì •í•˜ì„¸ìš”.</label>
                        <input type="file" class="form-control" id="profilePicture" name="profilePicture" style="display: none;"><br>
                        <div class="imgArea">
                            <img th:src="@{/img/profileIcon/add-photo.png}" alt="Profile Picture" id="profilePicturePreview" style="cursor: pointer; max-width: 150px;">
                        </div>
                        <div class="center-input">
                            <input type="text" class="form-control custom-name-input" id="nameInput"   name="nameInput" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”." maxlength="20">
                            <button class="btn btn-info" type="button" id="checkNickname" name="checkNickname" onclick="checkNick();" style="margin-top: 15px;">ì¤‘ë³µí™•ì¸</button>
                        </div>
                    </div>
                    <label for="genderSelection" style="margin-left:10px; margin-bottom: 30px; font-size:30px; font-family: 'GmarketSansMedium', sans-serif;">ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš”.</label>
                    <input type="hidden" id="genderSelection" name="genderSelection"> <!-- Hidden input to store the selected gender -->
                    <div class="gender-options" style="margin-bottom: 50px;">
                        <div class="gender-option">
                            <input type="checkbox" id="femaleCheckbox" class="gender-checkbox" value="ë‚¨ì">
                            <label for="femaleCheckbox"><img th:src="@{/img/profileIcon/female.png}" alt="female" style="width: 150px;"></label>
                        </div>
                        <div class="gender-option">
                            <input type="checkbox" id="maleCheckbox" class="gender-checkbox" value="ì—¬ì">
                            <label for="maleCheckbox"><img th:src="@{/img/profileIcon/male.png}" alt="male" style="width: 150px;"></label>
                        </div>
                    </div>

                    <label style="margin-left:10px; margin-bottom: 5px; font-size:30px; font-family: 'GmarketSansMedium', sans-serif;">ì„ í˜¸í•˜ëŠ” MBTIë¥¼ ì„ íƒí•˜ì„¸ìš”.ğŸ˜˜</label>
                    <label style="margin-left:10px; margin-bottom: 50px; font-size:20px; color:blue; font-family: 'GmarketSansLight', sans-serif;">*ì„ íƒí•˜ì§€ ì•Šìœ¼ì…”ë„ ë©ë‹ˆë‹¤.</label>
                    <div class="mbtiChk text-center" style="margin-bottom: 80px;">

                        <div class="form-check form-check-inline" >
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" name="loveChooseMBTI"  value="e">
                            <label class="form-check-label" for="inlineCheckbox1">E</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" name="loveChooseMBTI" value="i">
                            <label class="form-check-label" for="inlineCheckbox2">I</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox3" name="loveChooseMBTI" value="n">
                            <label class="form-check-label" for="inlineCheckbox3">N</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox4" name="loveChooseMBTI" value="s">
                            <label class="form-check-label" for="inlineCheckbox4">S</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox5" name="loveChooseMBTI" value="f">
                            <label class="form-check-label" for="inlineCheckbox5">F</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox6" name="loveChooseMBTI" value="t">
                            <label class="form-check-label" for="inlineCheckbox6">T</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox7" name="loveChooseMBTI" value="j">
                            <label class="form-check-label" for="inlineCheckbox7">J</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox8" name="loveChooseMBTI" value="p">
                            <label class="form-check-label" for="inlineCheckbox8">P</label>
                        </div>
                    </div>

                    <label style="margin-left:10px; margin-bottom: 5px;font-size:30px; font-family: 'GmarketSansMedium', sans-serif;">ë¶ˆí˜¸í•˜ëŠ” MBTIë¥¼ ì„ íƒí•˜ì„¸ìš”.ğŸ¤¬</label>
                    <label style="margin-left:10px; margin-bottom: 50px; font-size:20px; color:blue; font-family: 'GmarketSansLight', sans-serif;">*ì„ íƒí•˜ì§€ ì•Šìœ¼ì…”ë„ ë©ë‹ˆë‹¤.</label>
                    <div class="mbtiChk text-center" style="margin-bottom: 80px;">

                        <div class="form-check form-check-inline" >
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox9" name="hateChooseMBTI"  value="e">
                            <label class="form-check-label" for="inlineCheckbox1">E</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox10" name="hateChooseMBTI" value="i">
                            <label class="form-check-label" for="inlineCheckbox2">I</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox11" name="hateChooseMBTI" value="n">
                            <label class="form-check-label" for="inlineCheckbox3">N</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox12" name="hateChooseMBTI" value="s">
                            <label class="form-check-label" for="inlineCheckbox4">S</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox13" name="hateChooseMBTI" value="f">
                            <label class="form-check-label" for="inlineCheckbox5">F</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox14" name="hateChooseMBTI" value="t">
                            <label class="form-check-label" for="inlineCheckbox6">T</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox15" name="hateChooseMBTI" value="j">
                            <label class="form-check-label" for="inlineCheckbox7">J</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="inlineCheckbox16" name="hateChooseMBTI" value="p">
                            <label class="form-check-label" for="inlineCheckbox8">P</label>
                        </div>
                    </div>

                    <input type="hidden" id="nowPageNumber" name="nowPageNumber"  th:value="${nowPageNumber}">
                </form>
            </div>
            <div class="btn-area" style="display: flex; justify-content: space-between;">
                <button type="button" class="btn btn-outline-secondary" id="preBtn"  onclick="save();" style="border-radius: 15px; height: 60px; font-family: 'GmarketSansLight', sans-serif; font-size: 30px;">< ì´ì „</button>
                <button type="button" class="btn btn-outline-secondary" id="nextBtn"  onclick="next();" style="border-radius: 15px; height: 60px; font-family: 'GmarketSansLight', sans-serif; font-size: 30px;">ë‹¤ìŒ ></button>
            </div>
        </div>
    </div>
    <script>

        function checkNick(){
            const inputNick = $('#nameInput').val();
            console.log(inputNick);
            $.ajax({
                type: 'post',
                url: '/checkNickVal',
                data: {
                    checkNick: inputNick
                },
                dataType: 'json'
            }).done(function (data) {
                if (data.resultCode === 200) {
                    console.log(data);
                    alert('ì‚¬ìš©ê°€ëŠ¥í•œ ë‹‰ë„¤ì„ ì…ë‹ˆë‹¤.');
                    $('#nextBtn').prop('disabled', false);

                } else if (data.resultCode === 201) {
                    alert('ì´ë¯¸ ë“±ë¡ëœ ë‹‰ë„¤ì„ ì…ë‹ˆë‹¤\n ë‹¤ë¥¸ ë‹‰ë„¤ì„ì„ ì‚¬ìš©í•˜ì„¸ìš”.');
                    $('#nameInput').focus();
                }
            }).fail(function (xhr, error, status) {
                alert(error);
            });
        }

        //í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œ
        $(document).ready(function () {

            $('#nextBtn').prop('disabled', true);
            // When the profile picture image is clicked, trigger the file input click event
            $('#profilePicturePreview').click(function () {
                $('#profilePicture').click();
            });

            // When a file is selected, update the image preview
            $('#profilePicture').change(function () {
                const fileInput = this;
                const previewImage = $('#profilePicturePreview')[0];

                if (fileInput.files && fileInput.files[0]) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        // Set the image source to the selected file's data URL
                        previewImage.src = e.target.result;
                    };

                    reader.readAsDataURL(fileInput.files[0]);
                }
            });
        });

        // ì²´í¬ ë°•ìŠ¤ ì„ íƒ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” JavaScript
        const femaleCheckbox = document.getElementById('femaleCheckbox');
        const maleCheckbox = document.getElementById('maleCheckbox');
        const genderInput = document.getElementById('genderSelection');

        femaleCheckbox.addEventListener('change', function () {
            if (femaleCheckbox.checked) {
                maleCheckbox.checked = false; // ë‹¤ë¥¸ ì²´í¬ ë°•ìŠ¤ ì„ íƒ í•´ì œ
                genderInput.value = 'ì—¬ì„±'; // ì„ íƒëœ ì„±ë³„ì„ ìˆ¨ê²¨ì§„ ì…ë ¥ë€ì— ì €ì¥
            } else {
                genderInput.value = ''; // ì„ íƒì´ í•´ì œëœ ê²½ìš° ìˆ¨ê²¨ì§„ ì…ë ¥ ì´ˆê¸°í™”
            }
        });

        maleCheckbox.addEventListener('change', function () {
            if (maleCheckbox.checked) {
                femaleCheckbox.checked = false; // ë‹¤ë¥¸ ì²´í¬ ë°•ìŠ¤ ì„ íƒ í•´ì œ
                genderInput.value = 'ë‚¨ì„±'; // ì„ íƒëœ ì„±ë³„ì„ ìˆ¨ê²¨ì§„ ì…ë ¥ë€ì— ì €ì¥
            } else {
                genderInput.value = ''; // ì„ íƒì´ í•´ì œëœ ê²½ìš° ìˆ¨ê²¨ì§„ ì…ë ¥ ì´ˆê¸°í™”
            }
        });

        //ì´ë¦„ì„ ì…ë ¥í•´ì•¼
        function validated() {
            const nameInput = $('#nameInput');

            if($.trim( nameInput.val() ).length === 0 ) {
                nameInput.focus();
                return false;
            }

            return true;
        }

        // ì´ì „ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.addEventListener('DOMContentLoaded', function() {
            const preBtn = document.getElementById('preBtn');

            preBtn.addEventListener('click', function() {
                window.location.href = '/signin/first';
            });
        });

        function next() {
            // í”„ë¡œí•„ ì‚¬ì§„ì´ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
            const profilePictureInput = $('#profilePicture');
            const profilePicturePreview = $('#profilePicturePreview');
            const nameInput = $('#nameInput');

            if (!profilePictureInput[0].files.length) {
                alert('í”„ë¡œí•„ ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.');
                return;
            }

            if ($.trim(nameInput.val()).length === 0) {
                alert('ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”.');
                nameInput.focus();
                return;
            }

            // ì„ íƒí•œ ì„±ë³„ í™•ì¸
            const femaleCheckbox = document.getElementById('femaleCheckbox');
            const maleCheckbox = document.getElementById('maleCheckbox');

            if (!femaleCheckbox.checked && !maleCheckbox.checked) {
                alert('ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ajaxë¡œ ë°ì´í„° ì „ì†¡
            const formObj = $('#frm')[0];
            const formData = new FormData(formObj);

            $.ajax(
                {
                    url: '/nextStep2',
                    type: 'post',
                    dataType : 'json',
                    contentType: false,
                    processData : false,
                    data : formData
                }
            ).done(function(data){
                if(data.resultCode === 200) {
                    alert('ì •ë³´ ì…ë ¥ì´ ì™„ë£Œ ë˜ì—ˆìŠµë‹ˆë‹¤. mbti ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                    location.href = '/selectMbtiGo';    // ì»¤í”Œ ë¦¬ìŠ¤íŠ¸ ë©”ì¸ìœ¼ë¡œ ê°€ê¸°
                }else {
                    alert('íšŒì›ê°€ì…ì´ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤');
                    return false;
                }
            }).fail(function(xhr, error, status) {
                alert(error);
            });

        }
    </script>
</div>
</html>